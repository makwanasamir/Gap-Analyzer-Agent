# version: 1.0.0
version: 1.0.0
projectId: 00000000-0000-0000-0000-000000000000

appDefinitions:
  - id: app
    manifestPath: ./manifest/manifest.json

provision:
  - uses: botAadApp/create
    with:
      name: gap-analysis-bot
    writeToEnvironmentFile:
      clientId: BOT_ID
      clientSecret: BOT_PASSWORD
      objectId: BOT_OBJECT_ID
      tenantId: BOT_TENANT_ID

  - uses: azureAppService/create
    with:
      name: gap-analysis-bot
      sku: F1
    writeToEnvironmentFile:
      resourceId: BOT_AZURE_APP_SERVICE_RESOURCE_ID
      defaultDomain: BOT_ENDPOINT

  - uses: botFramework/create
    with:
      botId: ${{BOT_ID}}
      name: gap-analysis-bot
      messagingEndpoint: ${{BOT_ENDPOINT}}/api/messages
      description: ""
      channels:
        - name: msteams

deploy:
  - uses: azureAppService/zipDeploy
    with:
      artifactFolder: .
      resourceId: ${{BOT_AZURE_APP_SERVICE_RESOURCE_ID}}
